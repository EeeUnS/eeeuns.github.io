---
layout: post
title:  "5. DreamHack Linux Exploitation & Mitigation Part 2"
date:   2020-06-18 19:26:01 +0900
categories: paper
---


# 1. ASLR

Address Space Layout Randomization(ASLR)은 라이브러리, 힙, 스택 영역 등의 주소를 바이너리가 실행될 때마다 랜덤하게 바꿔 RTL과 같이 정해진 주소를 이용한 공격을 막기 위한 보호 기법

NX bit는 바이너리의 컴파일 옵션에 따라 적용 여부가 결정되었던 것과 달리, ASLR은 서버의 설정 파일에 의해 보호 기법의 적용이 결정됩니다.

1. 0 : ASLR을 적용하지 않음
2. 1 : 스택, 힙 메모리를 랜덤화
3. 2 : 스택, 힙, 라이브러리 메모리를 랜덤화

```
(gdb) disas main
Dump of assembler code for function main:
   0x5655556d <+0>:	push   ebp
   0x5655556e <+1>:	mov    ebp,esp
   0x56555570 <+3>:	push   ebx
   0x56555571 <+4>:	sub    esp,0x20
   0x56555574 <+7>:	call   0x56555470 <__x86.get_pc_thunk.bx>
   0x56555579 <+12>:	add    ebx,0x1a5b
   0x5655557f <+18>:	mov    ecx,0x0
   0x56555584 <+23>:	mov    eax,0x20
   0x56555589 <+28>:	and    eax,0xfffffffc
   0x5655558c <+31>:	mov    edx,eax
   0x5655558e <+33>:	mov    eax,0x0
   0x56555593 <+38>:	mov    DWORD PTR [ebp+eax*1-0x24],ecx
   0x56555597 <+42>:	add    eax,0x4
   0x5655559a <+45>:	cmp    eax,edx
   0x5655559c <+47>:	jb     0x56555593 <main+38>
   0x5655559e <+49>:	lea    eax,[ebx-0x1974]
   0x565555a4 <+55>:	push   eax
   0x565555a5 <+56>:	call   0x565553f0 <puts@plt>
   0x565555aa <+61>:	add    esp,0x4
   0x565555ad <+64>:	lea    eax,[ebx-0x1967]
   0x565555b3 <+70>:	push   eax
   0x565555b4 <+71>:	call   0x565553f0 <puts@plt>
   0x565555b9 <+76>:	add    esp,0x4
   0x565555bc <+79>:	lea    eax,[ebp-0x24]
   0x565555bf <+82>:	push   eax
   0x565555c0 <+83>:	lea    eax,[ebx-0x195b]
---Type <return> to continue, or q <return> to quit---
   0x565555c6 <+89>:	push   eax
   0x565555c7 <+90>:	call   0x56555410 <__isoc99_scanf@plt>
   0x565555cc <+95>:	add    esp,0x8
   0x565555cf <+98>:	mov    eax,0x0
   0x565555d4 <+103>:	mov    ebx,DWORD PTR [ebp-0x4]
   0x565555d7 <+106>:	leave  
   0x565555d8 <+107>:	ret    
End of assembler dump.
(gdb) r
Starting program: /home/ubuntu/asm/example4 
Hello World!
Hello ASLR!
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB

Program received signal SIGSEGV, Segmentation fault.
0xf7dfae00 in __libc_start_main () from /lib32/libc.so.6
(gdb) p/x $eip
$1 = 0xf7dfae00
(gdb) r
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /home/ubuntu/asm/example4 
Hello World!
Hello ASLR!
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBB

Program received signal SIGSEGV, Segmentation fault.
0x42424242 in ?? ()
(gdb) p/x $eip
$2 = 0x42424242
(gdb) 
```
저번 실습과같이 추가적인 4바이트 삽입이 있어야한다.

# 2. PLT, GOT Section

PLT는 고정 주소

# 3. 32bit Return Oriented Programming


android-studio-ide-193.6514223-linux.tar.gz
sudo tar -xvf android-studio-ide-193.6514223-linux.tar.gz
