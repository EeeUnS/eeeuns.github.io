



일단 생각없이 user- 폴더가서 make test를 해봤다. 싹 다 박살이나있더라

```
Kernel command line: -f -q
Kernel PANIC at ../../threads/vaddr.h:84 in vtop(): assertion `is_kernel_vaddr (vaddr)' failed.
Call stack: 0xc0028a4c 0xc002b2df 0xc002a960 0xc0020cdc 0xc00210e5 0xc0021172 0xc0022c8b 0xc0022f53 0xc002145d 0xc00217a2 0xc00205aa.
The `backtrace' program can make call stacks useful.
Read "Backtraces" in the "Debugging Tools" chapter
of the Pintos documentation for more information.
Timer: 0 ticks
Thread: 0 idle ticks, 0 kernel ticks, 0 user ticks
Console: 477 characters output
Keyboard: 0 keys pressed
Exception: 0 page faults
Powering off...
========================================================================
Bochs is exiting with the following message:
[UNMAP ] Shutdown port: shutdown requested
========================================================================
```

치우고 개요,명세부터 읽으러갔다. 고통.


1. 처음으로 해줄거는 `utils`에서 `pintos`와`Pintos.pm` 파일에서 처음 안되면서 수정해주었던 절대경로들을 `userprog/build/filename`으로 싹 수정해주는 것이다. thread 폴더 내의 build는 f 옵션자체가 지원이 안된다 

2. 절대경로대신에 예전 경로로 바꿔주고 kernel, loader가 존재하는 build 폴더에서 실행하면 딱히 문제가 없다.

아무튼 물론 그럼에도 테스트는 싹다 박살이 나있다.


```
euns@DESKTOP-6VB35LS:~/pintos/userprog/build$ backtrace kernel.o Call stack: 0xc0028a4c 0xc002b2df 0xc002a960 0xc0020cdc 0xc00210e5 0xc0021172 0xc0022c8b 0xc0022f53 0xc002145d 0xc00217a2 0xc00205aa.
0xc0028a4c: debug_panic (.../../lib/kernel/debug.c:38)
0xc002b2df: pagedir_activate (...../userprog/pagedir.c:230)
0xc002a960: process_activate (...../userprog/process.c:132)
0xc0020cdc: thread_schedule_tail (..../../threads/thread.c:709)
0xc00210e5: schedule (..../../threads/thread.c:738)
0xc0021172: thread_yield (..../../threads/thread.c:398)
0xc0022c8b: sema_up (...../../threads/synch.c:126)
0xc0022f53: lock_release (...../../threads/synch.c:265)
0xc002145d: allocate_tid (..../../threads/thread.c:752)
0xc00217a2: thread_init (..../../threads/thread.c:107)
0xc00205aa: main (...d/../../threads/init.c:91)
```

[stackoverflow](https://stackoverflow.com/questions/52472084/pintos-userprog-all-tests-fail-is-kernel-vaddr)




```
Acceptable output:
  (priority-condvar) begin
  (priority-condvar) Thread priority 23 starting.
  (priority-condvar) Thread priority 22 starting.
  (priority-condvar) Thread priority 21 starting.
  (priority-condvar) Thread priority 30 starting.
  (priority-condvar) Thread priority 29 starting.
  (priority-condvar) Thread priority 28 starting.
  (priority-condvar) Thread priority 27 starting.
  (priority-condvar) Thread priority 26 starting.
  (priority-condvar) Thread priority 25 starting.
  (priority-condvar) Thread priority 24 starting.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 30 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 29 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 28 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 27 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 26 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 25 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 24 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 23 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 22 woke up.
  (priority-condvar) Signaling...
  (priority-condvar) Thread priority 21 woke up.
  (priority-condvar) end
Differences in `diff -u' format:
  (priority-condvar) begin
  (priority-condvar) Thread priority 23 starting.
  (priority-condvar) Thread priority 22 starting.
  (priority-condvar) Thread priority 21 starting.
  (priority-condvar) Thread priority 30 starting.
  (priority-condvar) Thread priority 29 starting.
  (priority-condvar) Thread priority 28 starting.
  (priority-condvar) Thread priority 27 starting.
  (priority-condvar) Thread priority 26 starting.
  (priority-condvar) Thread priority 25 starting.
  (priority-condvar) Thread priority 24 starting.
  (priority-condvar) Signaling...
- (priority-condvar) Thread priority 30 woke up.
  (priority-condvar) Signaling...
+ (priority-condvar) Thread priority 30 woke up.
  (priority-condvar) Thread priority 29 woke up.
  (priority-condvar) Signaling...
- (priority-condvar) Thread priority 28 woke up.
  (priority-condvar) Signaling...
+ (priority-condvar) Thread priority 28 woke up.
  (priority-condvar) Thread priority 27 woke up.
  (priority-condvar) Signaling...
- (priority-condvar) Thread priority 26 woke up.
  (priority-condvar) Signaling...
+ (priority-condvar) Thread priority 26 woke up.
  (priority-condvar) Thread priority 25 woke up.
  (priority-condvar) Signaling...
- (priority-condvar) Thread priority 24 woke up.
  (priority-condvar) Signaling...
+ (priority-condvar) Thread priority 24 woke up.
  (priority-condvar) Thread priority 23 woke up.
  (priority-condvar) Signaling...
- (priority-condvar) Thread priority 22 woke up.
  (priority-condvar) Signaling...
+ (priority-condvar) Thread priority 22 woke up.
  (priority-condvar) Thread priority 21 woke up.
  (priority-condvar) end
```





Kernel PANIC at ../../threads/thread.c:402 in thread_yield(): assertion `!intr_context ()' failed.
Call stack: 0xc0028a6c 0xc0021141 0xc0022cab 0xc0025d45 0xc0021e06 0xc0021f3d 0xc0025798 0xc00257fc 0xc0025b92 0xc002082f.
The `backtrace' program can make call stacks useful.
Read "Backtraces" in the "Debugging Tools" chapter
of the Pintos documentation for more information.
Timer: 32 ticks
Thread: 14 idle ticks, 18 kernel ticks, 0 user ticks
Console: 617 characters output
Keyboard: 0 keys pressed
Exception: 0 page faults
Powering off..================================================