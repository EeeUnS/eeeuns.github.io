---
layout: post
title:  "4. DreamHack Linux Exploitation & Mitigation Part 1"
date:   2020-06-06 19:26:01 +0900
categories: paper
---


# Linux Exploitation & Mitigation Part 1

{% highlight c++ %}
// gcc -o example0 example0.c -m32
#include <stdio.h>

int main(void){
  int sum = 0;
  int val1 = 1;
  int val2 = 2;
  sum = val1 + val2;
  printf("1 + 2 = %d\n", sum);
  return 0;
}
{% endhighlight  %}



```asm
PS \asm> gdb ./exaple0.exe
GNU gdb (GDB) 8.1
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-w64-mingw32".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
./exaple0.exe: No such file or directory.
(gdb) disas main
No symbol table is loaded.  Use the "file" command.
(gdb) q
PS \asm> gdb ./example0
GNU gdb (GDB) 8.1
Copyright (C) 2018 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-w64-mingw32".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>.
Find the GDB manual and other documentation resources online at:
<http://www.gnu.org/software/gdb/documentation/>.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from ./example0...done.
(gdb) disas main
Dump of assembler code for function main:
   0x0000000000401550 <+0>:     push   %rbp
   0x0000000000401551 <+1>:     mov    %rsp,%rbp
   0x0000000000401554 <+4>:     sub    $0x30,%rsp
   0x0000000000401558 <+8>:     callq  0x401650 <__main>
   0x000000000040155d <+13>:    movl   $0x0,-0x4(%rbp)
   0x0000000000401564 <+20>:    movl   $0x1,-0x8(%rbp)
   0x000000000040156b <+27>:    movl   $0x2,-0xc(%rbp)
   0x0000000000401572 <+34>:    mov    -0x8(%rbp),%edx
   0x0000000000401575 <+37>:    mov    -0xc(%rbp),%eax
   0x0000000000401578 <+40>:    add    %edx,%eax
   0x000000000040157a <+42>:    mov    %eax,-0x4(%rbp)
   0x000000000040157d <+45>:    mov    -0x4(%rbp),%eax
   0x0000000000401580 <+48>:    mov    %eax,%edx
   0x0000000000401582 <+50>:    lea    0x2a77(%rip),%rcx        # 0x404000
   0x0000000000401589 <+57>:    callq  0x402a80 <printf>
   0x000000000040158e <+62>:    mov    $0x0,%eax
   0x0000000000401593 <+67>:    add    $0x30,%rsp
   0x0000000000401597 <+71>:    pop    %rbp
   0x0000000000401598 <+72>:    retq
   0x0000000000401599 <+73>:    nop
   0x000000000040159a <+74>:    nop
   0x000000000040159b <+75>:    nop
   0x000000000040159c <+76>:    nop
   0x000000000040159d <+77>:    nop
   0x000000000040159e <+78>:    nop
   0x000000000040159f <+79>:    nop
End of assembler dump.
(gdb)
```


```nasm
(gdb) disas main
Dump of assembler code for function main:
   0x0804840b <+00>:	push   ebp
   0x0804840c <+01>:	mov    ebp,esp
   0x0804840e <+03>:	sub    esp,0xc
   0x08048411 <+06>:	mov    DWORD PTR [ebp-0x4],0x0
   0x08048418 <+13>:	mov    DWORD PTR [ebp-0x8],0x1
   0x0804841f <+20>:	mov    DWORD PTR [ebp-0xc],0x2
   0x08048426 <+27>:	mov    edx,DWORD PTR [ebp-0x8]
   0x08048429 <+30>:	mov    eax,DWORD PTR [ebp-0xc]
   0x0804842c <+33>:	add    eax,edx
   0x0804842e <+35>:	mov    DWORD PTR [ebp-0x4],eax
   0x08048431 <+38>:	push   DWORD PTR [ebp-0x4]
   0x08048434 <+41>:	push   0x80484d0
   0x08048439 <+46>:	call   0x80482e0 <printf@plt>
   0x0804843e <+51>:	add    esp,0x8
   0x08048441 <+54>:	mov    eax,0x0
   0x08048446 <+59>:	leave  
   0x08048447 <+60>:	ret    
End of assembler dump.
(gdb) 
```